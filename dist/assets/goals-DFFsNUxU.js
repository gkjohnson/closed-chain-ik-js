import{W as M,P as S,S as k,C as R,D as W,A as D,G as I,L as E,J as T,a as s,I as q,b as y,g as F,c as G}from"./IKRootsHelper-DmBdh0X7.js";import{S as O,O as H,T as j}from"./stats.module-BFsq5STz.js";import{G as z}from"./Goal-DJOimEJ_.js";const r={controls:"translate",solvePosition:!0,solveRotation:!1},A={maxIterations:3,divergeThreshold:.005,stallThreshold:.001,translationErrorClamp:.25,rotationErrorClamp:.25,translationConvergeThreshold:.001,rotationConvergeThreshold:.001,restPoseFactor:.001};let m,x,P,a,i,l,f,v,d,w,p,n,e;U();L();function U(){x=new O,document.body.appendChild(x.dom),P=document.getElementById("output"),a=new M({antialias:!0}),a.setPixelRatio(window.devicePixelRatio),a.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(a.domElement),l=new S(50,window.innerWidth/window.innerHeight),l.position.set(8,8,8),i=new k,i.background=new R(1250841);const h=new W;h.position.set(1,3,2),i.add(h);const b=new D(2503224,1);i.add(b),p=new H(l,a.domElement),n=new j(l,a.domElement),n.setSpace("local"),i.add(n.getHelper()),n.addEventListener("mouseDown",()=>p.enabled=!1),n.addEventListener("mouseUp",()=>p.enabled=!0),e=new I,e.position.set(0,1,1),i.add(e),n.attach(e),d=null;let g=null;for(let t=0;t<6;t++){const c=new E,o=new T;o.setPosition(0,.5,0),o.setDoF(t%2?s.EX:s.EZ),o.setDoFValues(Math.PI/4),o.setRestPoseValues(Math.PI/4),o.restPoseSet=!0,o.setMinLimits(-.9*Math.PI),o.setMaxLimits(.9*Math.PI),c.addChild(o),g&&g.addChild(c),d===null&&(d=c),g=o}const u=new E;u.setPosition(0,.5,0),g.addChild(u),d.updateMatrixWorld(!0),e.matrix.set(...u.matrixWorld).transpose(),e.matrix.decompose(e.position,e.quaternion,e.scale),w=new z,w.makeClosure(u),v=new q(d),v.setColor(15277667),i.add(v),f=new y(d),Object.assign(f,A);function C(){const t=[];r.solvePosition&&t.push(s.X,s.Y,s.Z),r.solveRotation&&t.push(s.EX,s.EY,s.EZ),w.setGoalDoF(...t)}C(),m=new F,m.width=350,m.add(r,"controls",["rotate","translate"]).listen().onChange(t=>{n.setMode(t)}),m.add(r,"solvePosition").onChange(C),m.add(r,"solveRotation").onChange(C),n.addEventListener("mouseUp",()=>{d.updateMatrixWorld(!0),e.matrix.set(...u.matrixWorld).transpose(),e.matrix.decompose(e.position,e.quaternion,e.scale)}),window.addEventListener("resize",()=>{const t=window.innerWidth,c=window.innerHeight,o=t/c;a.setSize(t,c),l.aspect=o,l.updateProjectionMatrix()}),window.addEventListener("keydown",t=>{switch(t.key){case"w":n.setMode("translate"),r.controls="translate";break;case"e":n.setMode("rotate"),r.controls="rotate";break;case"f":p.target.set(0,0,0),p.update();break}})}function L(){requestAnimationFrame(L),w.setPosition(e.position.x,e.position.y,e.position.z),w.setQuaternion(e.quaternion.x,e.quaternion.y,e.quaternion.z,e.quaternion.w),P.textContent=f.solve().map(h=>G[h]).join(`
`),a.render(i,l),x.update()}
